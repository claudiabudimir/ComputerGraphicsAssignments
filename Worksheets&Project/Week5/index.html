<head>
    <meta name="author" content="Carlos Ventura">
    <script type="text/javascript" src="../Utilities/initShaders.js"></script>
    <script type="text/javascript" src="../Utilities/MV.js"></script>
    <script type="text/javascript" src="../Utilities/webgl-utils.js"></script>
    <script type="text/javascript" src="../Utilities/OBJParser.js"></script>
    <meta charset="UTF-8">

    <style>
        h1,
        h2 {
            text-align: center;
        }

        ul {
            text-align: left;
            list-style-position: inside;
            font-size: larger
        }

        body {
            background-image: url('../BG.png');
            -webkit-background-size: cover;
            -moz-background-size: cover;
            -o-background-size: cover;
            background-size: cover;

            font-family: Arial;
        }

        button {
            font-weight: bold;
        }

        canvas {
            padding: 0;
            margin: auto;
            display: block;
        }

        hr.dashed {
            border-top: 3px dashed white;
        }

        div{
            width: 25%; margin: 0 auto;font-weight: bolder;font-size: large;
        }
    

    </style>
</head>

<html>

<body>
    <h1>Week 6 Exercises</h1>
    <h2>WORKSHEET 5: Rendering a triangle mesh </h2>
    <hr class="dashed">

    <h2>Part 3 - Load OBJ file</h2>
    <canvas id="gl-canvas3" width="512" height="512">
        Web browser does not support HTML5’s canvas element.
    </canvas>
    <hr class="dashed">

    <h2>Part 4 - Shade Object</h2>
    <canvas id="gl-canvas4" width="512" height="512">
        Web browser does not support HTML5’s canvas element.
    </canvas>
    <br>
    <div class="slidecontainer">
        Ambient reflectivity coefficient (Ka) <br>
        0<input type="range" min="0" max="1" step="0.01" value="0.50" id="Ka4">1
        &nbsp;&nbsp;&nbsp;&nbsp;Value = <span id="Kav4"></span><br>

        Diffuse reflectivity coefficient (Kd)<br>
        0<input type="range" min="0" max="1" step="0.01" value="0.1" id="Kd4">1
        &nbsp;&nbsp;&nbsp;&nbsp;Value = <span id="Kdv4"></span><br>

         Specular reflectivity coefficient (Ks)<br>
        0<input type="range" min="0" max="1" step="0.01" value="1.0" id="Ks4">1
        &nbsp;&nbsp;&nbsp;Value = <span id="Ksv4"></span><br>

        <span >Shininess(s)</span><br>
        0<input type="range" min="0" max="100" value="18" id="s4">100 &nbsp;&nbsp;Value = <span id="sv4"></span><br>

        Emitted radiance(Le)<br>
        0<input type="range" min="0" max="2" step="0.01" value="1.35" id="Le4">2
        &nbsp;&nbsp;&nbsp;&nbsp;Value = <span id="Lev4"></span><br>
    </div>

    <ul>
        <li><b>QUESTION:</b> Explain how you obtain and use surface normals, and explain how this relates to the surface
            smoothness when you are rendering a triangle mesh.</li>
        <li><b>ANSWER:</b> I obtain the normals using the OBJ file. Even though I don't pass the normals directly to the
            fragment shader, I use them on the vertex shader on a variable passed to the fragment shader (N).
            This relates to smoothness since this is how phong shading works, it computes for every pixel it's color
            based on the interpolated surface normals.
        </li>
    </ul>

   <!--Part 3 -->

    <script id="vertex-shader-3" type="x-shader/x-vertex">
        attribute vec4 a_Position;
        attribute vec4 a_Normal; 
        attribute vec4 a_Color;

        varying vec4 v_Color;
        
        uniform mat4 modelViewMatrix;
        uniform mat4 projectMatrix;

        void main() {
            gl_Position =  projectMatrix * modelViewMatrix * a_Position ;
            v_Color = a_Color;
        }
     
            </script>
    <script id="fragment-shader-3" type="x-shader/x-fragment">
        precision mediump float;
        varying vec4 v_Color;
        void main(){
            gl_FragColor = v_Color;
        }
      
            </script>
    <script type="text/javascript" src="W05P3.js"></script>

   <!--Part 4 -->

    <script id="vertex-shader-4" type="x-shader/x-vertex">
        attribute vec4 a_Position;
        attribute vec4 a_Normal;
        attribute vec4 a_Color;
        varying vec3 N, L, E;
        uniform mat4 modelViewMatrix;
        uniform mat4 projectMatrix;
        uniform vec4 lightPosition;
        varying vec4 v2_Color;

        void main(){

            vec3 pos = (modelViewMatrix * a_Position).xyz;
            vec3 light = lightPosition.xyz;
            L = normalize(light - pos);
            E = normalize(-pos);
            N = normalize(vec4(a_Normal.xyz, 0).xyz);
       
            v2_Color = a_Color;
            gl_Position = projectMatrix * modelViewMatrix * a_Position;

        }
    
            </script>
    <script id="fragment-shader-4" type="x-shader/x-fragment">
        precision mediump float;
        varying vec3 N, L, E;
        varying vec4 v2_Color;
        
        uniform float Ka, Ks, Kd, alpha, le;

        void main(){

            vec4 v_Color;

            vec3 H = normalize(L + E);

            float dif = max(dot(L, normalize(N)), 0.0);

            float spec = pow(max(dot(normalize(N), H), 0.0), alpha);


            vec4 ambient = vec4((Ka * vec3(le)), 1.0);
            vec4 specular = vec4((Ks * spec * vec3(le)), 1.0);
            vec4 diffuse = vec4((Kd * dif *vec3(le)), 1.0);
            
            if( dot(L, N) < 0.0 ) {
                specular = vec4(0.0, 0.0, 0.0, 1.0);
            } 

            v_Color = (ambient + specular + diffuse) * v2_Color; 


            gl_FragColor = v_Color;
        }
     
            </script>
    <script type="text/javascript" src="W05P4.js"></script>

</body>
</html>